<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Rats &amp; Restaurants Analysis</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="report.html">Project Report</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="intro.html">Introduction</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="data_sources.html">Data Sources</a>
    </li>
    <li>
      <a href="data_overview.html">Data Overview</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="sightings.html">Rat Sightings Analysis</a>
    </li>
    <li>
      <a href="weather.html">Rats &amp; Weather Analysis</a>
    </li>
    <li>
      <a href="trash.html">Rats &amp; Trash Analysis</a>
    </li>
    <li>
      <a href="restaurant.html">Rats &amp; Restaurant Analysis</a>
    </li>
    <li>
      <a href="social.html">Rats &amp; Social Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Conclusions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="visualization.html">Data Visualization</a>
    </li>
    <li>
      <a href="results.html">Results</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About Us</a>
</li>
<li>
  <a href="https://austin-hsin.github.io/P8105_Final_Project/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Rats &amp; Restaurants Analysis</h1>

</div>


<p>Similar to the trash and sightings findings, we wanted to investigate
whether NYC restaurant inspections, specifically health inspection
violation code 04K, evidence of rats, would reveal greater insight into
NYC’s rat problem.</p>
<pre class="r"><code>#Importing NYC Restaurant Inspections csv
inspections_df = read_csv(&quot;./data/NYC_Restaurant_Inspections.csv&quot;) |&gt;
  janitor::clean_names() |&gt;
  separate(inspection_date, c(&quot;Month&quot;, &quot;Day&quot;, &quot;Year&quot;), sep = &quot;/&quot;) |&gt;
  select(-Day) |&gt; #can remove other columns as needed
  filter(as.numeric(Year) &gt; 2015)</code></pre>
<pre><code>## Rows: 209461 Columns: 27
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (16): DBA, BORO, BUILDING, STREET, PHONE, CUISINE DESCRIPTION, INSPECTIO...
## dbl (10): CAMIS, ZIPCODE, SCORE, Latitude, Longitude, Community Board, Counc...
## lgl  (1): Location Point1
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>First, we analyzed the trend of 04K violations in all 5 boroughs from
2016 to 2023.</p>
<pre class="r"><code>#Observations of violations
violations_plot_df &lt;- inspections_df |&gt;
  group_by(Year, boro, violation_code) |&gt;
  mutate(code_obs = n())

#Plotting 04K violations by year and boro
violations_plot_df |&gt;
  filter(violation_code == &quot;04K&quot;) |&gt;
  ggplot(aes(x = as.numeric(Year), y = code_obs, color = boro)) +
  geom_point() +
  geom_line() +
  scale_x_continuous(
    breaks = c(2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023), 
    labels = c(2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023)) +
  labs(title = &quot;04K Violations by Boro 2016-2023&quot;) +
  xlab(&quot;Year&quot;)</code></pre>
<p><img src="restaurant_files/figure-html/violation%20plot%20trend-1.png" width="90%" /></p>
<p>From the plot, we can see that for the entire city, rat violations
were not very common up until 2022 where the city saw a modest increase
in 2021, but a massive leap into 2022. This parallels the trends found
in the sightings analysis and may reflect a lack of appropriate
surveillance/reporting on the city’s part and the subsequent push for
higher health standards following the Covid-19 pandemic.</p>
<p>Next, we investigated the number of rat violations to the number of
other creature violations, “04L”, “04M”, and “04O” where “04L” is
evidence of mice, “04M” is evidence of roaches, and “04O” is the
presence of live animal(s), other than fish in tank or service
animals.</p>
<pre class="r"><code>#Plotting 04K violations to other 04 violations
violations_plot_df |&gt;
  filter(violation_code %in% c(&quot;04K&quot;,&quot;04M&quot;,&quot;04L&quot;, &quot;04O&quot;)) |&gt;
  mutate(violation_code = recode(violation_code, &quot;04K&quot; = &quot;Rats&quot;,&quot;04M&quot; = &quot;Roaches&quot;,&quot;04L&quot; = &quot;Mice&quot;, &quot;04O&quot; = &quot;Other&quot;)) |&gt;
  ggplot(aes(x = violation_code, fill = violation_code)) +
  geom_bar() +
  labs(title = &quot;Comparison of &#39;04&#39; NYC Restaurant Violation Codes 2016-2023&quot;) +
  scale_x_discrete(limits = c(&quot;Mice&quot;, &quot;Roaches&quot;, &quot;Rats&quot;, &quot;Other&quot;)) +
  xlab(&quot;Restaurant Creature Violations&quot;) +
  ylab(&quot;Number of Violations&quot;)</code></pre>
<p><img src="restaurant_files/figure-html/04%20violation%20comparison-1.png" width="90%" /></p>
<p>Interestingly enough, roach and mice violations have heavily
outnumbered the number of rat violations and potentially undercuts the
severity of NYC’s perceived rat problems. However, given that rodents
and roaches thrive in similar environments, it is possible that
solutions for reducing rat populations may spillover in deterring mice
and roach populations.</p>
<p>Finally, we wanted to examine which types of restaurants had the most
rat violations in NYC.</p>
<pre class="r"><code>#Plotting 04K violations by cuisine type
violations_plot_df |&gt;
  filter(violation_code == &quot;04K&quot;) |&gt;
  group_by(cuisine_description) |&gt;
  mutate(cuisine_obs = n()) |&gt;
  filter(cuisine_obs &gt; 25) |&gt;
  ggplot(aes(x = reorder(cuisine_description, cuisine_obs), 
             y = cuisine_obs)) +
  geom_point(aes(color = cuisine_description)) +
  theme(axis.text.x = element_text(angle = 40, hjust = 1)) +
  labs(title = &quot;Top 20 Rat Violation Offenders by Cuisine Type 2016-2023&quot;) +
  theme(legend.position = &#39;none&#39;) +
  xlab(&quot;Cuisine Type&quot;) +
  ylab(&quot;Number of Rat Violations&quot;) +
  scale_y_continuous(breaks = c(50, 100, 150, 200, 250, 300))</code></pre>
<p><img src="restaurant_files/figure-html/top%2020%20cuisine%2004k%20violations-1.png" width="90%" /></p>
<p>From the plot we can see that the bottom 18 cuisine types, left to
right, trend upward steadily and range from 50 to 125 total violations.
Then we see the top 2 cuisine types, Chinese and American, where the
skyrockets to around 300 total violations. While this plot is not
reflective of individual restaurants of these cuisine categories, it
does help increase the weight of potential lower sanitation scores at
such restaurants.</p>
<p>Finally, we wanted to</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
